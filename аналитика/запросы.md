# Перед вами реляционная модель данных. Необходимо написать SQL-запросы.

![image](https://github.com/cyberlizka/-/assets/164761247/b460a9c2-90bb-4376-b198-6d6ee864b194)


**Создадим таблицы**

![image](https://github.com/cyberlizka/-/assets/164761247/5dfd64e3-7247-4193-8603-1764cf3ada78)
```
CREATE TABLE Покупатели (
    Идентификатор INT PRIMARY KEY,
    Имя VARCHAR(50),
    Фамилия VARCHAR(50),
    Дата_рождения DATE
);

CREATE TABLE Товары (
    Идентификатор INT PRIMARY KEY,
    Название VARCHAR(100),
    Стоимость DECIMAL(10, 2)
);

CREATE TABLE Покупки (
    Идентификатор INT PRIMARY KEY,
    Ключ_покупателя INT,
    Ключ_товара INT,
    Дата_покупки DATE,
    FOREIGN KEY (Ключ_покупателя) REFERENCES Покупатели(Идентификатор),
    FOREIGN KEY (Ключ_товара) REFERENCES Товары(Идентификатор)
);
```
**Вставка данных**

![image](https://github.com/cyberlizka/-/assets/164761247/82fffe9f-fa99-462d-9d09-4cbc3f215741)
```

INSERT INTO Покупатели (Идентификатор, Имя, Фамилия, Дата_рождения) VALUES
(1, 'Иван', 'Иванов', '1980-01-01'),
(2, 'Петр', 'Петров', '1990-02-02'),
(3, 'Сидор', 'Сидоров', '1985-03-03');

INSERT INTO Товары (Идентификатор, Название, Стоимость) VALUES
(1, 'Товар1', 100.00),
(2, 'Товар2', 200.00),
(3, 'Товар3', 300.00);

INSERT INTO Покупки (Идентификатор, Ключ_покупателя, Ключ_товара, Дата_покупки) VALUES
(1, 1, 1, '2023-01-01'),
(2, 1, 2, '2023-02-01'),
(3, 2, 2, '2023-03-01'),
(4, 2, 3, '2023-04-01'),
(5, 3, 3, '2023-05-01');
```

**Запрос: Вывести покупателей с количеством осуществленных покупок**

![image](https://github.com/cyberlizka/-/assets/164761247/c312f138-113f-4af4-869e-59a50b7c50dc)
```
SELECT Покупатели.Имя, Покупатели.Фамилия, COUNT(Покупки.Идентификатор) AS Количество_покупок
FROM Покупатели
JOIN Покупки ON Покупатели.Идентификатор = Покупки.Ключ_покупателя
GROUP BY Покупатели.Идентификатор, Покупатели.Имя, Покупатели.Фамилия;
```

**Запрос: Вывести общую стоимость товаров для каждого покупателя и отсортировать результат в порядке убывания**

![image](https://github.com/cyberlizka/-/assets/164761247/10cff6d9-7988-473c-bec6-670e41835925)
```
SELECT Покупатели.Имя, Покупатели.Фамилия, SUM(Товары.Стоимость) AS Общая_стоимость
FROM Покупатели
JOIN Покупки ON Покупатели.Идентификатор = Покупки.Ключ_покупателя
JOIN Товары ON Покупки.Ключ_товара = Товары.Идентификатор
GROUP BY Покупатели.Идентификатор, Покупатели.Имя, Покупатели.Фамилия
ORDER BY Общая_стоимость DESC;
```
**Запрос: Получить покупателей, купивших только один товар**

![image](https://github.com/cyberlizka/-/assets/164761247/7c885b16-308a-4dc1-be8b-823f3c1459ab)
```
SELECT Покупатели.Имя, Покупатели.Фамилия
FROM Покупатели
JOIN Покупки ON Покупатели.Идентификатор = Покупки.Ключ_покупателя
GROUP BY Покупатели.Идентификатор, Покупатели.Имя, Покупатели.Фамилия
HAVING COUNT(Покупки.Идентификатор) = 1;
```
