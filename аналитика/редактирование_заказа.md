# Описание функции редактирования заказа

**Бизнес-требования и их приоритеты**

![image](https://github.com/cyberlizka/-/assets/164761247/ca245252-f2dd-478c-8db1-a585c2761b45)

**Критерии качества на входе (DoR)**

    1. Бизнес-требования согласованы с заказчиком и руководителем проекта.
    2. Системные требования согласованы с лидом разработки и руководителем проекта.
    3. Задачи поставлены ясно и понятны для всех участников команды, и нет открытых вопросов.
    4. У задачи описаны критерии приемки.
    5. Функциональная спецификация должна быть декомпозирована на задачи продолжительностью не более 16 часов каждая.
    6. К задачам на интеграцию должна быть приложена диаграмма последовательности.
    7. Для каждой задачи должны быть установлены все зависимости.
    
**Acceptance Criteria (AC)**


    1. Пользователь может открыть страницу с деталями заказа для редактирования.
    2. Все поля заказа доступны для редактирования, включая товары, количество, адрес доставки и контактную информацию.
    3. После внесения изменений пользователь должен иметь возможность сохранить отредактированный заказ.
    4. Система должна проверять корректность введенных данных (например, правильность формата email или адреса).
    5. После сохранения изменений пользователь должен видеть подтверждение об успешном обновлении заказа.
    6. Изменения должны быть отражены в базе данных и доступны для просмотра как пользователю, так и администратору.
    7. При возникновении ошибок при сохранении изменений, система должна отобразить соответствующее сообщение об ошибке и предоставить пользователю возможность исправить данные.

**Ограничения**


    1. Не должна быть затронута логика работы с платежными системами при редактировании заказа, чтобы избежать проблем с оплатой.
    2. Не должна быть затронута логика отмены заказов, чтобы не создавать конфликтов с функцией отмены заказов.
    3. Не должна быть затронута логика создания новых заказов, так как функция редактирования должна быть отделена от логики создания новых заказов.
    4. Не должна быть затронута логика авторизации, чтобы доступ к функции редактирования был доступен только авторизованным пользователям.
    
**Концепция решения**

  > функцию редактирования заказа, которая позволит зарегистрированным пользователям вносить изменения в свои заказы после их размещения.
 

**Sequence диаграмма**


![image](https://github.com/cyberlizka/-/assets/164761247/038eae36-e3ce-463a-b4e7-7f6212ecef00)
```
@startuml
participant Клиент
participant Сервер
participant Сервис_Авторизации
participant База_Данных
participant Сервис_Уведомлений

activate Клиент
Клиент -> Сервер: PUT /orders/{orderId} (обновленные данные заказа)
activate Сервер
    Сервер -> Сервис_Авторизации: Проверка авторизации
    activate Сервис_Авторизации
        Сервис_Авторизации --> Сервер: 200 OK (авторизован)
    deactivate Сервис_Авторизации
    
    Сервер -> База_Данных: GET /orders/{orderId} 
    activate База_Данных
        База_Данных --> Сервер: 200 OK (данные заказа)
    deactivate База_Данных

    alt Заказ найден
        Сервер -> База_Данных: Проверка валидности обновленных данных
        activate База_Данных
            База_Данных --> Сервер: 200 OK (данные валидны)
        deactivate База_Данных

        alt Проверка успешна
            Сервер -> База_Данных: PUT /orders/{orderId} (обновленные данные заказа)
            activate База_Данных
                База_Данных --> Сервер: 200 OK (заказ обновлен)
            deactivate База_Данных
            Сервер -> Сервис_Уведомлений: Отправить уведомление об обновлении заказа
            activate Сервис_Уведомлений
                Сервис_Уведомлений --> Сервер: 200 OK (уведомление отправлено)
            deactivate Сервис_Уведомлений
            Сервер -> Клиент: 200 OK (заказ обновлен)
        else Проверка не успешна
            Сервер -> Клиент: 400 Bad Request (некорректные данные)
        end

    else Заказ не найден
        Сервер -> Клиент: 404 Not Found (заказ не найден)
    end

deactivate Сервер
deactivate Клиент

@enduml
```

**Функциональные требования**

![image](https://github.com/cyberlizka/-/assets/164761247/b5ed8382-bf70-442e-8af1-01449dc32701)

**Use Cases**

![image](https://github.com/cyberlizka/-/assets/164761247/7e6d0b92-0f4f-44d1-a9e8-5a6bd029db32)

![image](https://github.com/cyberlizka/-/assets/164761247/287c9116-d6bd-4d8e-b7ca-17dee3d22066)

**Модели данных**

**Сущности системы и их связи (ERD): Хранение информации о покупках пользователя**

>Информация о покупках пользователя хранится в реляционной базе данных. Для этого используются несколько таблиц, которые связаны между собой.

![image](https://github.com/cyberlizka/-/assets/164761247/8781afaf-8f90-451d-95ad-d0bccd2f60ee)
```
@startuml
entity Users {
  userId <<PK>>
  firstName varchar(255)
  secondName varchar(255)
  email varchar(255)
  password varchar(255)
  birthDate date
}

entity Product {
  producId int <<PK>>
  name varchar(255)
  description text
  price decimal
}

entity Orders {
  orderId int <<PK>>
  userId int
  orderDate date
  status varchar(255)
}

entity OrderItem {
  id int <<PK>>
  orderId int
  productId int
  quantity int
}

entity Payment {
  paymentId int <<PK>>
  orderId int
  amount decimal
  paymentMethod varchar(255)
  paymentDate date
}

Users "1" --* "1..*" Orders : creates  **Связь один ко многим: один пользователь может создать несколько заказов**
Orders "1" --* "1..*" OrderItem : contains **Связь один ко многим: один заказ может содержать несколько товаров**
Product "1" --* "1..*" OrderItem : includes **Связь один ко многим: один товар может быть включен в несколько заказов**
Orders "1" --* "1" Payment : has **Связь один к одному: один заказ имеет одну платежную информацию**

note right of Users
  **Хранит информацию о пользователях:**
  * userId - уникальный идентификатор пользователя
  * firstName - имя пользователя
  * secondName - фамилия пользователя
  * email - электронная почта пользователя
  * password - пароль пользователя
  * birthDate - дата рождения пользователя
end note

note right of Product
  **Хранит информацию о товарах:**
  * producId - уникальный идентификатор товара
  * name - название товара
  * description - описание товара
  * price - цена товара
end note

note right of Orders
  **Хранит информацию о заказах:**
  * orderId - уникальный идентификатор заказа
  * userId - идентификатор пользователя, создавшего заказ
  * orderDate - дата создания заказа
  * status - статус заказа (например, "Оформлен", "В обработке", "Отправлен", "Доставлен")
end note

note right of OrderItem
  **Хранит информацию о товарах в заказе:**
  * id - уникальный идентификатор позиции в заказе
  * orderId - идентификатор заказа
  * productId - идентификатор товара
  * quantity - количество товара в заказе
end note

note right of Payment
  **Хранит информацию о платеже:**
  * paymentId - уникальный идентификатор платежа
  * orderId - идентификатор заказа
  * amount - сумма платежа
  * paymentMethod - способ оплаты
  * paymentDate - дата платежа
end note

@enduml
```
**Описание структуры данных**

< Пользователь

![image](https://github.com/cyberlizka/-/assets/164761247/1689442f-13b1-4d3f-8b8a-33052eb279d5)


**Нефункциональные требования**
